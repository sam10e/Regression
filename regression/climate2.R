# Sam Tenney
# Climate 2

# From climate.R
# NASA temperature data
temp_full <- read.table(text = '
Year   Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec    J-D D-N    DJF  MAM  JJA  SON  Year
1969   -10  -14    1   18   19    5   -2    3    9   13   13   28      7   3    -12   13    2   11  1969
1970     9   22    8    9   -4   -2   -2   -9   11    6    2  -12      3   7     20    4   -4    6  1970
1971    -2  -19  -17   -8   -5  -19  -11   -3   -4   -6   -5   -9     -9  -9    -11  -10  -11   -5  1971
1972   -24  -16    2    0   -4    6    1   17    2    9    4   19      1  -1    -16    0    8    5  1972
1973    29   31   27   26   25   18   10    3   10   14    6   -6     16  18     26   26   10   10  1973
1974   -15  -29   -6  -12   -2   -6   -5   11  -11   -8   -7   -9     -8  -8    -16   -7    0   -9  1974
1975     7    6   13    5   16    0   -1  -19   -3   -9  -16  -17     -2  -1      1   11   -7   -9  1975
1976    -1   -6  -21   -8  -24  -16  -10  -15   -9  -26   -4   10    -11 -13     -8  -18  -13  -13  1976
1977    19   22   25   28   30   24   20   16    0    2   17    3     17  18     17   27   20    7  1977
1978     6   14   21   15    6   -2    3  -17    6    0   16   10      6   6      8   14   -5    7  1978
1979    12  -10   18   13    5   13    2   14   25   24   28   47     16  13      4   12   10   26  1979
1980    30   42   30   33   36   17   28   23   19   18   29   19     27  29     40   33   23   22  1980
1981    55   41   49   31   24   32   34   32   17   14   24   43     33  31     38   35   33   18  1981
1982    10   15   -1   10   16    5   13    7   14   13   15   43     13  13     23    8    8   14  1982
1983    52   40   42   31   36   20   17   33   39   16   32   17     31  33     45   36   23   29  1983
1984    30   17   29    8   33    5   17   16   21   16    6   -5     16  18     21   23   13   14  1984
1985    22   -7   17   11   17   17   -1   14   15   11    8   15     12  10      3   15   10   11  1985
1986    28   39   27   24   24   11   11   12    0   13   11   16     18  18     27   25   11    8  1986
1987    36   45   16   22   25   37   45   28   39   32   25   48     33  31     33   21   37   32  1987
1988    57   43   51   45   44   43   34   47   41   40   12   33     41  42     49   47   41   31  1988
1989    15   35   37   33   17   15   33   37   37   32   20   38     29  29     28   29   28   30  1989
1990    40   41   76   55   46   38   43   30   29   41   45   41     44  44     40   59   37   38  1990
1991    40   49   35   52   37   53   47   39   48   30   31   32     41  42     43   41   46   36  1991
1992    44   41   47   23   32   25   11    7   -1    9    3   21     22  23     39   34   14    4  1992
1993    37   38   36   26   27   25   28   13   10   22    6   16     24  24     32   30   22   13  1993
1994    27    2   26   40   28   42   30   21   29   41   46   36     31  29     15   31   31   39  1994
1995    51   78   45   47   26   41   47   45   32   47   45   28     44  45     55   39   44   41  1995
1996    25   48   32   36   26   25   35   48   25   19   41   40     33  32     34   31   36   28  1996
1997    31   38   53   36   35   53   34   41   53   62   64   59     47  45     36   41   43   60  1997
1998    60   90   63   63   69   77   68   66   42   44   49   56     62  62     69   65   70   45  1998
1999    48   65   34   32   31   37   37   31   41   39   38   43     40  41     56   32   35   39  1999
2000    24   56   57   57   36   41   38   42   40   28   32   29     40  41     41   50   40   33  2000
2001    42   44   56   51   56   54   60   48   54   51   70   56     53  51     38   54   54   58  2001
2002    75   75   90   56   63   55   61   53   62   55   58   44     62  63     69   70   56   58  2002
2003    73   55   57   53   60   47   53   65   64   74   52   73     61  58     57   57   55   64  2003
2004    58   72   64   63   38   43   24   43   50   64   70   51     53  55     68   55   37   61  2004
2005    72   57   69   66   63   66   63   60   74   76   71   65     67  66     60   66   63   74  2005
2006    56   69   62   50   46   64   52   70   61   67   70   73     62  61     63   52   62   66  2006
2007    95   70   69   73   66   58   60   57   59   57   55   46     64  66     79   69   58   57  2007
2008    23   34   72   51   47   45   58   43   62   63   64   53     51  51     34   57   49   63  2008
2009    61   51   51   58   64   64   69   65   67   63   76   65     63  62     55   58   66   69  2009
2010    73   79   91   85   73   62   59   62   59   68   77   46     70  71     72   83   61   68  2010
2011    48   50   62   62   50   57   71   71   54   62   55   53     58  57     48   58   66   57  2011
2012    44   47   55   67   74   62   53   61   72   74   73   52     61  61     48   66   59   73  2012
2013    66   55   65   53   57   65   57   66   77   67   78   65     64  63     57   58   63   74  2013
2014    73   51   76   76   85   66   55   81   88   81   66   78     73  72     63   79   67   78  2014
2015    81   86   90   74   75   79   71   78   81  107  102  110     86  83     82   80   76   97  2015
2016   115  134  130  107   91   77   82  100   87   89   90   83     99 101    119  109   86   89  2016
2017    97  112  112   92   88   69   82   86   75   87   85   88     89  89     97   97   79   82  2017
                        ', header = TRUE, sep = "")

# Make each row a month
temp_full <- temp_full[, 1:13] # Filters out columns so dataset just has Year and the months
dim(temp_full)
newtemp <- data.frame(temp=matrix(t(temp_full[2:13]), ncol = 1))
newtemp$month <- rep(1:12, 49)
newtemp$year <- rep(1969:2017, each=12)

# CO2 data found at: ftp://aftp.cmdl.noaa.gov/data/trace_gases/co2/flask/surface/co2_mlo_surface-flask_1_ccgg_month.txt
co2_full <- read.table(text = '
site year month co2
MLO 1969  8   322.51
MLO 1969  9   321.36
MLO 1969 10   320.74
MLO 1969 11   321.98
MLO 1969 12   323.78
MLO 1970  1   325.13
MLO 1970  2   325.54
MLO 1970  3   325.67
MLO 1970  4   326.58
MLO 1970  5   327.68
MLO 1970  6   327.30
MLO 1970  7   326.13
MLO 1970  8   324.91
MLO 1970  9   322.98
MLO 1970 10   322.65
MLO 1970 11   324.04
MLO 1970 12   325.54
MLO 1976  7   332.30
MLO 1976  8   331.04
MLO 1976  9   329.67
MLO 1976 10   329.33
MLO 1976 11   330.47
MLO 1976 12   331.97
MLO 1977  1   332.77
MLO 1977  2   333.10
MLO 1977  3   334.08
MLO 1977  4   335.78
MLO 1977  5   336.49
MLO 1977  6   335.96
MLO 1977  7   334.64
MLO 1977  8   332.31
MLO 1977  9   330.66
MLO 1977 10   330.55
MLO 1977 11   331.72
MLO 1977 12   333.74
MLO 1978  1   335.17
MLO 1978  2   335.78
MLO 1978  3   336.69
MLO 1978  4   337.76
MLO 1978  5   338.01
MLO 1978  6   337.57
MLO 1978  7   336.17
MLO 1978  8   333.89
MLO 1978  9   332.18
MLO 1978 10   332.20
MLO 1978 11   333.24
MLO 1978 12   334.64
MLO 1979  1   336.11
MLO 1979  2   337.20
MLO 1979  3   338.50
MLO 1979  4   339.00
MLO 1979  5   338.93
MLO 1979  6   338.97
MLO 1979  7   337.78
MLO 1979  8   335.57
MLO 1979  9   333.95
MLO 1979 10   334.41
MLO 1979 11   335.66
MLO 1979 12   336.81
MLO 1980  1   338.88
MLO 1980  2   340.17
MLO 1980  3   341.33
MLO 1980  4   342.82
MLO 1980  5   342.90
MLO 1980  6   341.74
MLO 1980  7   339.16
MLO 1980  8   337.04
MLO 1980  9   336.60
MLO 1980 10   336.60
MLO 1980 11   337.55
MLO 1980 12   339.18
MLO 1981  1   340.41
MLO 1981  2   341.39
MLO 1981  3   342.33
MLO 1981  4   343.35
MLO 1981  5   343.56
MLO 1981  6   342.34
MLO 1981  7   340.40
MLO 1981  8   338.67
MLO 1981  9   337.37
MLO 1981 10   337.53
MLO 1981 11   338.88
MLO 1981 12   340.21
MLO 1982  1   341.10
MLO 1982  2   341.99
MLO 1982  3   343.03
MLO 1982  4   343.82
MLO 1982  5   343.76
MLO 1982  6   342.87
MLO 1982  7   341.47
MLO 1982  8   339.26
MLO 1982  9   337.32
MLO 1982 10   337.64
MLO 1982 11   339.04
MLO 1982 12   340.65
MLO 1983  1   341.96
MLO 1983  2   342.37
MLO 1983  3   343.11
MLO 1983  4   345.12
MLO 1983  5   346.09
MLO 1983  6   345.30
MLO 1983  7   343.53
MLO 1983  8   341.20
MLO 1983  9   339.77
MLO 1983 10   339.98
MLO 1983 11   341.14
MLO 1983 12   342.73
MLO 1984  1   343.94
MLO 1984  2   344.59
MLO 1984  3   345.52
MLO 1984  4   346.81
MLO 1984  5   347.38
MLO 1984  6   346.62
MLO 1984  7   345.10
MLO 1984  8   342.86
MLO 1984  9   341.29
MLO 1984 10   341.70
MLO 1984 11   343.01
MLO 1984 12   343.91
MLO 1985  1   344.60
MLO 1985  2   345.65
MLO 1985  3   346.86
MLO 1985  4   347.80
MLO 1985  5   348.57
MLO 1985  6   348.19
MLO 1985  7   346.22
MLO 1985  8   343.94
MLO 1985  9   342.83
MLO 1985 10   342.87
MLO 1985 11   344.05
MLO 1985 12   345.31
MLO 1986  1   346.10
MLO 1986  2   346.62
MLO 1986  3   347.69
MLO 1986  4   349.29
MLO 1986  5   349.94
MLO 1986  6   349.06
MLO 1986  7   347.06
MLO 1986  8   345.26
MLO 1986  9   344.05
MLO 1986 10   343.81
MLO 1986 11   345.37
MLO 1986 12   346.84
MLO 1987  1   347.51
MLO 1987  2   348.25
MLO 1987  3   349.26
MLO 1987  4   350.75
MLO 1987  5   351.77
MLO 1987  6   351.40
MLO 1987  7   349.62
MLO 1987  8   347.48
MLO 1987  9   346.45
MLO 1987 10   346.81
MLO 1987 11   348.11
MLO 1987 12   349.42
MLO 1988  1   350.28
MLO 1988  2   351.35
MLO 1988  3   352.52
MLO 1988  4   353.72
MLO 1988  5   354.35
MLO 1988  6   353.83
MLO 1988  7   352.34
MLO 1988  8   350.12
MLO 1988  9   348.77
MLO 1988 10   349.12
MLO 1988 11   350.14
MLO 1988 12   351.61
MLO 1989  1   352.74
MLO 1989  2   353.14
MLO 1989  3   353.96
MLO 1989  4   355.54
MLO 1989  5   356.16
MLO 1989  6   355.45
MLO 1989  7   354.00
MLO 1989  8   351.38
MLO 1989  9   349.51
MLO 1989 10   349.90
MLO 1989 11   351.53
MLO 1989 12   352.88
MLO 1990  1   354.02
MLO 1990  2   355.11
MLO 1990  3   355.90
MLO 1990  4   356.71
MLO 1990  5   357.17
MLO 1990  6   356.32
MLO 1990  7   354.53
MLO 1990  8   352.44
MLO 1990  9   351.21
MLO 1990 10   351.52
MLO 1990 11   353.10
MLO 1990 12   354.66
MLO 1991  1   355.24
MLO 1991  2   356.10
MLO 1991  3   357.54
MLO 1991  4   358.68
MLO 1991  5   359.34
MLO 1991  6   358.27
MLO 1991  7   355.86
MLO 1991  8   353.82
MLO 1991  9   352.42
MLO 1991 10   352.53
MLO 1991 11   354.00
MLO 1991 12   355.44
MLO 1992  1   356.64
MLO 1992  2   357.29
MLO 1992  3   358.12
MLO 1992  4   359.17
MLO 1992  5   359.94
MLO 1992  6   359.48
MLO 1992  7   357.17
MLO 1992  8   355.02
MLO 1992  9   353.69
MLO 1992 10   353.56
MLO 1992 11   354.63
MLO 1992 12   355.97
MLO 1993  1   356.81
MLO 1993  2   357.39
MLO 1993  3   358.25
MLO 1993  4   359.56
MLO 1993  5   360.47
MLO 1993  6   359.69
MLO 1993  7   357.74
MLO 1993  8   355.54
MLO 1993  9   353.84
MLO 1993 10   354.20
MLO 1993 11   355.41
MLO 1993 12   356.90
MLO 1994  1   358.28
MLO 1994  2   358.86
MLO 1994  3   359.68
MLO 1994  4   361.04
MLO 1994  5   361.73
MLO 1994  6   360.83
MLO 1994  7   358.93
MLO 1994  8   356.94
MLO 1994  9   355.33
MLO 1994 10   355.55
MLO 1994 11   357.49
MLO 1994 12   359.57
MLO 1995  1   360.24
MLO 1995  2   360.62
MLO 1995  3   361.82
MLO 1995  4   362.93
MLO 1995  5   363.63
MLO 1995  6   363.27
MLO 1995  7   361.36
MLO 1995  8   359.17
MLO 1995  9   358.04
MLO 1995 10   358.09
MLO 1995 11   359.44
MLO 1995 12   361.01
MLO 1996  1   362.10
MLO 1996  2   363.20
MLO 1996  3   364.18
MLO 1996  4   364.81
MLO 1996  5   365.35
MLO 1996  6   365.13
MLO 1996  7   363.51
MLO 1996  8   361.13
MLO 1996  9   359.30
MLO 1996 10   359.38
MLO 1996 11   360.92
MLO 1996 12   362.02
MLO 1997  1   363.07
MLO 1997  2   363.89
MLO 1997  3   364.91
MLO 1997  4   366.56
MLO 1997  5   366.67
MLO 1997  6   365.49
MLO 1997  7   364.09
MLO 1997  8   362.16
MLO 1997  9   360.50
MLO 1997 10   360.71
MLO 1997 11   362.52
MLO 1997 12   364.15
MLO 1998  1   365.26
MLO 1998  2   366.04
MLO 1998  3   367.12
MLO 1998  4   368.65
MLO 1998  5   369.39
MLO 1998  6   368.98
MLO 1998  7   367.74
MLO 1998  8   365.74
MLO 1998  9   364.13
MLO 1998 10   364.14
MLO 1998 11   365.60
MLO 1998 12   367.52
MLO 1999  1   368.36
MLO 1999  2   368.63
MLO 1999  3   369.76
MLO 1999  4   370.89
MLO 1999  5   370.89
MLO 1999  6   370.42
MLO 1999  7   369.14
MLO 1999  8   366.95
MLO 1999  9   365.12
MLO 1999 10   365.43
MLO 1999 11   366.82
MLO 1999 12   368.36
MLO 2000  1   369.62
MLO 2000  2   370.13
MLO 2000  3   370.85
MLO 2000  4   371.81
MLO 2000  5   371.90
MLO 2000  6   371.38
MLO 2000  7   370.07
MLO 2000  8   368.11
MLO 2000  9   366.89
MLO 2000 10   367.14
MLO 2000 11   368.37
MLO 2000 12   369.61
MLO 2001  1   370.73
MLO 2001  2   371.82
MLO 2001  3   372.84
MLO 2001  4   373.69
MLO 2001  5   374.18
MLO 2001  6   373.36
MLO 2001  7   371.35
MLO 2001  8   369.41
MLO 2001  9   368.18
MLO 2001 10   368.45
MLO 2001 11   370.13
MLO 2001 12   371.43
MLO 2002  1   372.18
MLO 2002  2   372.94
MLO 2002  3   373.92
MLO 2002  4   374.80
MLO 2002  5   375.52
MLO 2002  6   375.55
MLO 2002  7   373.86
MLO 2002  8   371.19
MLO 2002  9   369.72
MLO 2002 10   370.45
MLO 2002 11   372.40
MLO 2002 12   373.65
MLO 2003  1   374.63
MLO 2003  2   375.77
MLO 2003  3   376.81
MLO 2003  4   378.08
MLO 2003  5   378.88
MLO 2003  6   378.26
MLO 2003  7   376.52
MLO 2003  8   374.53
MLO 2003  9   372.95
MLO 2003 10   373.13
MLO 2003 11   374.84
MLO 2003 12   376.03
MLO 2004  1   376.85
MLO 2004  2   377.81
MLO 2004  3   379.46
MLO 2004  4   380.74
MLO 2004  5   380.78
MLO 2004  6   379.62
MLO 2004  7   377.37
MLO 2004  8   375.56
MLO 2004  9   374.23
MLO 2004 10   374.54
MLO 2004 11   376.25
MLO 2004 12   377.61
MLO 2005  1   378.58
MLO 2005  2   380.19
MLO 2005  3   381.75
MLO 2005  4   382.15
MLO 2005  5   382.49
MLO 2005  6   382.25
MLO 2005  7   380.80
MLO 2005  8   378.63
MLO 2005  9   376.79
MLO 2005 10   377.05
MLO 2005 11   378.65
MLO 2005 12   380.10
MLO 2006  1   381.22
MLO 2006  2   381.92
MLO 2006  3   382.84
MLO 2006  4   384.73
MLO 2006  5   385.42
MLO 2006  6   384.06
MLO 2006  7   382.29
MLO 2006  8   380.06
MLO 2006  9   378.71
MLO 2006 10   379.11
MLO 2006 11   380.39
MLO 2006 12   381.80
MLO 2007  1   383.26
MLO 2007  2   384.42
MLO 2007  3   385.40
MLO 2007  4   386.49
MLO 2007  5   386.89
MLO 2007  6   386.31
MLO 2007  7   384.54
MLO 2007  8   381.65
MLO 2007  9   380.31
MLO 2007 10   381.16
MLO 2007 11   382.63
MLO 2007 12   384.06
MLO 2008  1   385.53
MLO 2008  2   385.71
MLO 2008  3   385.57
MLO 2008  4   387.05
MLO 2008  5   388.70
MLO 2008  6   388.46
MLO 2008  7   386.66
MLO 2008  8   384.24
MLO 2008  9   382.77
MLO 2008 10   382.91
MLO 2008 11   384.13
MLO 2008 12   385.66
MLO 2009  1   386.97
MLO 2009  2   387.71
MLO 2009  3   388.41
MLO 2009  4   389.34
MLO 2009  5   390.11
MLO 2009  6   389.52
MLO 2009  7   387.70
MLO 2009  8   385.84
MLO 2009  9   384.44
MLO 2009 10   384.60
MLO 2009 11   386.00
MLO 2009 12   387.51
MLO 2010  1   388.59
MLO 2010  2   389.72
MLO 2010  3   391.07
MLO 2010  4   392.60
MLO 2010  5   393.37
MLO 2010  6   392.25
MLO 2010  7   390.09
MLO 2010  8   388.00
MLO 2010  9   386.55
MLO 2010 10   387.21
MLO 2010 11   388.57
MLO 2010 12   390.06
MLO 2011  1   391.56
MLO 2011  2   392.14
MLO 2011  3   392.64
MLO 2011  4   393.69
MLO 2011  5   394.27
MLO 2011  6   393.80
MLO 2011  7   392.35
MLO 2011  8   389.96
MLO 2011  9   388.61
MLO 2011 10   389.16
MLO 2011 11   390.47
MLO 2011 12   392.17
MLO 2012  1   393.00
MLO 2012  2   393.25
MLO 2012  3   394.66
MLO 2012  4   396.56
MLO 2012  5   396.98
MLO 2012  6   395.85
MLO 2012  7   394.26
MLO 2012  8   392.20
MLO 2012  9   390.84
MLO 2012 10   391.10
MLO 2012 11   393.06
MLO 2012 12   394.64
MLO 2013  1   395.66
MLO 2013  2   396.80
MLO 2013  3   397.74
MLO 2013  4   398.70
MLO 2013  5   399.61
MLO 2013  6   399.15
MLO 2013  7   397.19
MLO 2013  8   395.01
MLO 2013  9   393.73
MLO 2013 10   393.87
MLO 2013 11   395.43
MLO 2013 12   397.02
MLO 2014  1   397.91
MLO 2014  2   398.33
MLO 2014  3   399.75
MLO 2014  4   401.64
MLO 2014  5   402.24
MLO 2014  6   401.39
MLO 2014  7   398.96
MLO 2014  8   396.53
MLO 2014  9   395.34
MLO 2014 10   395.67
MLO 2014 11   397.50
MLO 2014 12   399.26
MLO 2015  1   400.05
MLO 2015  2   400.38
MLO 2015  3   401.58
MLO 2015  4   403.68
MLO 2015  5   404.16
MLO 2015  6   402.92
MLO 2015  7   400.93
MLO 2015  8   398.90
MLO 2015  9   397.65
MLO 2015 10   398.23
MLO 2015 11   399.95
MLO 2015 12   401.52
MLO 2016  1   402.72
MLO 2016  2   403.62
MLO 2016  3   405.23
MLO 2016  4   407.35
MLO 2016  5   407.87
MLO 2016  6   406.57
MLO 2016  7   404.37
MLO 2016  8   401.69
MLO 2016  9   400.23
MLO 2016 10   401.48
MLO 2016 11   403.52
MLO 2016 12   404.66
MLO 2017  1   405.54
MLO 2017  2   406.27
MLO 2017  3   407.35
MLO 2017  4   409.01
MLO 2017  5   409.79
MLO 2017  6   408.72
MLO 2017  7   406.97
MLO 2017  8   404.87
MLO 2017  9   403.11
MLO 2017 10   403.44
MLO 2017 11   405.24
MLO 2017 12   406.69
', header = TRUE, sep = "")

# CH4 data found at: ftp://aftp.cmdl.noaa.gov/data/trace_gases/ch4/flask/surface/ch4_mlo_surface-flask_1_ccgg_month.txt 
ch4_full <- read.table(text = '
site year month methane
MLO 1983  5  1639.29
MLO 1983  6  1633.53
MLO 1983  7  1633.18
MLO 1983  8  1631.39
MLO 1983  9  1648.42
MLO 1983 10  1663.75
MLO 1983 11  1658.24
MLO 1983 12  1654.32
MLO 1984  1  1658.97
MLO 1984  2  1656.49
MLO 1984  3  1655.74
MLO 1984  4  1657.69
MLO 1984  5  1649.37
MLO 1984  6  1633.95
MLO 1984  7  1629.70
MLO 1984  8  1643.76
MLO 1984  9  1663.30
MLO 1984 10  1673.72
MLO 1984 11  1676.11
MLO 1984 12  1671.21
MLO 1985  1  1662.44
MLO 1985  2  1665.25
MLO 1985  3  1677.35
MLO 1985  4  1674.25
MLO 1985  5  1665.98
MLO 1985  6  1658.63
MLO 1985  7  1653.47
MLO 1985  8  1653.74
MLO 1985  9  1667.62
MLO 1985 10  1680.79
MLO 1985 11  1679.96
MLO 1985 12  1677.27
MLO 1986  1  1675.09
MLO 1986  2  1666.12
MLO 1986  3  1672.10
MLO 1986  4  1687.75
MLO 1986  5  1685.35
MLO 1986  6  1684.31
MLO 1986  7  1681.99
MLO 1986  8  1669.88
MLO 1986  9  1679.74
MLO 1986 10  1690.42
MLO 1986 11  1691.77
MLO 1986 12  1697.36
MLO 1987  1  1692.00
MLO 1987  2  1689.70
MLO 1987  3  1694.39
MLO 1987  4  1695.56
MLO 1987  5  1694.22
MLO 1987  6  1687.17
MLO 1987  7  1680.58
MLO 1987  8  1678.22
MLO 1987  9  1681.05
MLO 1987 10  1700.84
MLO 1987 11  1715.97
MLO 1987 12  1707.55
MLO 1988  1  1697.68
MLO 1988  2  1700.59
MLO 1988  3  1705.46
MLO 1988  4  1707.57
MLO 1988  5  1705.16
MLO 1988  6  1698.45
MLO 1988  7  1687.23
MLO 1988  8  1691.21
MLO 1988  9  1700.77
MLO 1988 10  1708.26
MLO 1988 11  1719.28
MLO 1988 12  1725.75
MLO 1989  1  1720.86
MLO 1989  2  1712.66
MLO 1989  3  1715.04
MLO 1989  4  1723.46
MLO 1989  5  1724.39
MLO 1989  6  1713.18
MLO 1989  7  1699.85
MLO 1989  8  1706.65
MLO 1989  9  1720.84
MLO 1989 10  1721.99
MLO 1989 11  1726.21
MLO 1989 12  1730.71
MLO 1990  1  1727.94
MLO 1990  2  1728.50
MLO 1990  3  1733.85
MLO 1990  4  1737.54
MLO 1990  5  1734.60
MLO 1990  6  1722.31
MLO 1990  7  1712.69
MLO 1990  8  1718.03
MLO 1990  9  1733.90
MLO 1990 10  1736.92
MLO 1990 11  1741.50
MLO 1990 12  1749.65
MLO 1991  1  1734.87
MLO 1991  2  1731.05
MLO 1991  3  1746.56
MLO 1991  4  1749.59
MLO 1991  5  1747.37
MLO 1991  6  1740.02
MLO 1991  7  1730.92
MLO 1991  8  1722.05
MLO 1991  9  1734.64
MLO 1991 10  1751.77
MLO 1991 11  1750.34
MLO 1991 12  1752.44
MLO 1992  1  1755.62
MLO 1992  2  1750.09
MLO 1992  3  1752.42
MLO 1992  4  1753.28
MLO 1992  5  1744.61
MLO 1992  6  1743.34
MLO 1992  7  1736.27
MLO 1992  8  1725.77
MLO 1992  9  1729.87
MLO 1992 10  1740.78
MLO 1992 11  1755.36
MLO 1992 12  1758.39
MLO 1993  1  1747.88
MLO 1993  2  1745.72
MLO 1993  3  1747.98
MLO 1993  4  1746.75
MLO 1993  5  1749.63
MLO 1993  6  1745.59
MLO 1993  7  1731.91
MLO 1993  8  1732.03
MLO 1993  9  1744.56
MLO 1993 10  1760.24
MLO 1993 11  1768.07
MLO 1993 12  1763.57
MLO 1994  1  1759.89
MLO 1994  2  1752.13
MLO 1994  3  1754.67
MLO 1994  4  1763.81
MLO 1994  5  1755.18
MLO 1994  6  1746.67
MLO 1994  7  1737.41
MLO 1994  8  1734.01
MLO 1994  9  1757.23
MLO 1994 10  1778.62
MLO 1994 11  1781.17
MLO 1994 12  1779.36
MLO 1995  1  1764.55
MLO 1995  2  1757.13
MLO 1995  3  1764.84
MLO 1995  4  1762.94
MLO 1995  5  1762.23
MLO 1995  6  1759.23
MLO 1995  7  1749.36
MLO 1995  8  1751.19
MLO 1995  9  1761.52
MLO 1995 10  1768.91
MLO 1995 11  1768.34
MLO 1995 12  1772.99
MLO 1996  1  1771.36
MLO 1996  2  1770.49
MLO 1996  3  1769.90
MLO 1996  4  1759.10
MLO 1996  5  1755.07
MLO 1996  6  1753.80
MLO 1996  7  1747.17
MLO 1996  8  1745.62
MLO 1996  9  1767.21
MLO 1996 10  1774.69
MLO 1996 11  1769.97
MLO 1996 12  1773.10
MLO 1997  1  1769.96
MLO 1997  2  1768.70
MLO 1997  3  1775.64
MLO 1997  4  1780.64
MLO 1997  5  1776.65
MLO 1997  6  1768.26
MLO 1997  7  1751.52
MLO 1997  8  1750.35
MLO 1997  9  1775.73
MLO 1997 10  1784.89
MLO 1997 11  1784.08
MLO 1997 12  1783.28
MLO 1998  1  1772.27
MLO 1998  2  1766.15
MLO 1998  3  1774.64
MLO 1998  4  1780.41
MLO 1998  5  1781.22
MLO 1998  6  1779.11
MLO 1998  7  1762.52
MLO 1998  8  1757.24
MLO 1998  9  1771.18
MLO 1998 10  1787.42
MLO 1998 11  1798.40
MLO 1998 12  1803.06
MLO 1999  1  1796.37
MLO 1999  2  1784.78
MLO 1999  3  1788.17
MLO 1999  4  1788.41
MLO 1999  5  1773.27
MLO 1999  6  1771.20
MLO 1999  7  1766.99
MLO 1999  8  1768.67
MLO 1999  9  1785.90
MLO 1999 10  1794.49
MLO 1999 11  1796.53
MLO 1999 12  1801.91
MLO 2000  1  1802.08
MLO 2000  2  1793.86
MLO 2000  3  1791.93
MLO 2000  4  1786.87
MLO 2000  5  1773.91
MLO 2000  6  1772.34
MLO 2000  7  1769.45
MLO 2000  8  1762.09
MLO 2000  9  1773.90
MLO 2000 10  1796.97
MLO 2000 11  1798.70
MLO 2000 12  1790.78
MLO 2001  1  1789.20
MLO 2001  2  1793.36
MLO 2001  3  1801.04
MLO 2001  4  1797.35
MLO 2001  5  1783.18
MLO 2001  6  1773.35
MLO 2001  7  1769.24
MLO 2001  8  1764.69
MLO 2001  9  1779.91
MLO 2001 10  1790.89
MLO 2001 11  1793.05
MLO 2001 12  1796.07
MLO 2002  1  1787.41
MLO 2002  2  1782.89
MLO 2002  3  1786.13
MLO 2002  4  1781.94
MLO 2002  5  1778.35
MLO 2002  6  1774.58
MLO 2002  7  1766.39
MLO 2002  8  1766.11
MLO 2002  9  1780.44
MLO 2002 10  1795.44
MLO 2002 11  1801.16
MLO 2002 12  1792.64
MLO 2003  1  1785.93
MLO 2003  2  1791.78
MLO 2003  3  1796.91
MLO 2003  4  1794.96
MLO 2003  5  1786.92
MLO 2003  6  1790.57
MLO 2003  7  1785.31
MLO 2003  8  1773.06
MLO 2003  9  1788.24
MLO 2003 10  1806.05
MLO 2003 11  1807.63
MLO 2003 12  1794.55
MLO 2004  1  1789.80
MLO 2004  2  1797.93
MLO 2004  3  1806.92
MLO 2004  4  1805.51
MLO 2004  5  1787.77
MLO 2004  6  1779.82
MLO 2004  7  1774.58
MLO 2004  8  1769.81
MLO 2004  9  1778.21
MLO 2004 10  1790.72
MLO 2004 11  1800.51
MLO 2004 12  1796.71
MLO 2005  1  1788.48
MLO 2005  2  1796.11
MLO 2005  3  1802.80
MLO 2005  4  1791.28
MLO 2005  5  1780.89
MLO 2005  6  1780.05
MLO 2005  7  1771.30
MLO 2005  8  1766.47
MLO 2005  9  1787.26
MLO 2005 10  1806.12
MLO 2005 11  1803.13
MLO 2005 12  1798.35
MLO 2006  1  1794.46
MLO 2006  2  1785.87
MLO 2006  3  1786.20
MLO 2006  4  1800.62
MLO 2006  5  1798.36
MLO 2006  6  1779.65
MLO 2006  7  1765.35
MLO 2006  8  1762.15
MLO 2006  9  1775.52
MLO 2006 10  1788.46
MLO 2006 11  1791.46
MLO 2006 12  1794.60
MLO 2007  1  1799.19
MLO 2007  2  1802.63
MLO 2007  3  1802.62
MLO 2007  4  1801.64
MLO 2007  5  1795.26
MLO 2007  6  1781.34
MLO 2007  7  1771.37
MLO 2007  8  1778.96
MLO 2007  9  1793.77
MLO 2007 10  1801.88
MLO 2007 11  1803.34
MLO 2007 12  1805.13
MLO 2008  1  1809.45
MLO 2008  2  1803.01
MLO 2008  3  1792.36
MLO 2008  4  1792.10
MLO 2008  5  1796.03
MLO 2008  6  1791.31
MLO 2008  7  1782.39
MLO 2008  8  1779.42
MLO 2008  9  1794.57
MLO 2008 10  1813.66
MLO 2008 11  1811.92
MLO 2008 12  1812.38
MLO 2009  1  1816.15
MLO 2009  2  1814.75
MLO 2009  3  1815.26
MLO 2009  4  1807.05
MLO 2009  5  1802.74
MLO 2009  6  1806.24
MLO 2009  7  1794.24
MLO 2009  8  1788.10
MLO 2009  9  1801.86
MLO 2009 10  1811.50
MLO 2009 11  1814.69
MLO 2009 12  1815.54
MLO 2010  1  1810.91
MLO 2010  2  1817.90
MLO 2010  3  1821.23
MLO 2010  4  1818.00
MLO 2010  5  1816.53
MLO 2010  6  1803.08
MLO 2010  7  1793.49
MLO 2010  8  1800.62
MLO 2010  9  1810.57
MLO 2010 10  1826.33
MLO 2010 11  1830.55
MLO 2010 12  1821.18
MLO 2011  1  1823.70
MLO 2011  2  1819.71
MLO 2011  3  1815.46
MLO 2011  4  1815.99
MLO 2011  5  1811.55
MLO 2011  6  1810.25
MLO 2011  7  1803.07
MLO 2011  8  1799.92
MLO 2011  9  1813.08
MLO 2011 10  1823.81
MLO 2011 11  1827.45
MLO 2011 12  1831.80
MLO 2012  1  1827.56
MLO 2012  2  1819.26
MLO 2012  3  1824.05
MLO 2012  4  1834.89
MLO 2012  5  1829.58
MLO 2012  6  1814.01
MLO 2012  7  1803.90
MLO 2012  8  1804.00
MLO 2012  9  1815.79
MLO 2012 10  1828.91
MLO 2012 11  1836.47
MLO 2012 12  1836.24
MLO 2013  1  1833.34
MLO 2013  2  1836.95
MLO 2013  3  1838.78
MLO 2013  4  1830.34
MLO 2013  5  1825.23
MLO 2013  6  1814.80
MLO 2013  7  1804.78
MLO 2013  8  1813.65
MLO 2013  9  1838.15
MLO 2013 10  1844.51
MLO 2013 11  1840.43
MLO 2013 12  1848.08
MLO 2014  1  1840.72
MLO 2014  2  1831.04
MLO 2014  3  1847.04
MLO 2014  4  1855.55
MLO 2014  5  1844.21
MLO 2014  6  1831.50
MLO 2014  7  1818.95
MLO 2014  8  1824.30
MLO 2014  9  1841.04
MLO 2014 10  1844.03
MLO 2014 11  1854.78
MLO 2014 12  1863.88
MLO 2015  1  1853.42
MLO 2015  2  1848.70
MLO 2015  3  1858.36
MLO 2015  4  1866.28
MLO 2015  5  1862.21
MLO 2015  6  1844.58
MLO 2015  7  1831.97
MLO 2015  8  1827.56
MLO 2015  9  1840.38
MLO 2015 10  1860.36
MLO 2015 11  1866.16
MLO 2015 12  1863.48
MLO 2016  1  1858.25
MLO 2016  2  1858.35
MLO 2016  3  1864.57
MLO 2016  4  1873.35
MLO 2016  5  1870.74
MLO 2016  6  1855.72
MLO 2016  7  1835.74
MLO 2016  8  1840.71
MLO 2016  9  1863.16
MLO 2016 10  1876.20
MLO 2016 11  1874.30
MLO 2016 12  1864.87
MLO 2017  1  1870.49
MLO 2017  2  1869.30
MLO 2017  3  1862.79
MLO 2017  4  1867.97
MLO 2017  5  1869.48
MLO 2017  6  1856.73
MLO 2017  7  1839.51
MLO 2017  8  1839.46
MLO 2017  9  1862.77
MLO 2017 10  1882.64
MLO 2017 11  1885.28
MLO 2017 12  1879.49'
, header = TRUE, sep = "")

# Merge the datasets and clean up
climate <- merge(merge(newtemp,co2_full, by = c("year", "month"), all.x=TRUE), ch4_full, by=c("year", "month"), all.x=TRUE)
climate <- subset(climate, !is.na(site.x) & !is.na(site.y))
climate <- climate[, c("year", "month", "temp", "co2", "methane")]

# Add columns to climate
# Monthly Atmospheric N2O Concentration in ppb (1999-present)
n2o <- read.table(header = TRUE, text="
year month n2o sd n
1999       7    315.16      0.33    546
1999       8    315.07      0.29    643
1999       9    315.08      0.27    473
1999      10    315.17      0.26    615
1999      11    315.46      0.28    569
1999      12    315.41      0.41    380
2000       1    315.55      0.41    542
2000       2    315.78      0.42    591
2000       3    315.70      0.39    728
2000       4    315.79      0.41    676
2000       5    315.76      0.40    636
2000       6    316.03      0.38    529
2000       7    316.17      0.37    558
2000       8    315.83      0.36    161
2000       9    316.64      0.30    211
2000      10    316.48      0.31    677
2000      11    316.71      0.60    138
2000      12    316.53      0.64    632
2001       1    316.62      0.70    430
2001       2    316.71      0.73    648
2001       3    316.69      0.81    728
2001       4    316.53      0.68    691
2001       5    316.57      0.57    739
2001       6    316.66      0.85    346
2001       7    316.82      0.58    635
2001       8    316.94      0.63    724
2001       9    317.05      0.62    708
2001      10    317.30      0.82    668
2001      11    317.36      0.74    621
2001      12    317.39      0.73    630
2002       1    317.51      0.68    669
2002       2    317.17      0.75    654
2002       3    317.50      0.90    646
2002       4    317.48      0.93    674
2002       5    317.91      0.81    282
2002       6     nan        nan       0
2002       7     nan        nan       0
2002       8     nan        nan       0
2002       9    317.49      0.46    141
2002      10    317.71      0.32    668
2002      11    317.82      0.31    670
2002      12    317.77      0.26    691
2003       1    317.90      0.25    659
2003       2    317.79      0.23    634
2003       3    318.05      0.25    735
2003       4    318.07      0.24    674
2003       5    318.17      0.23    716
2003       6    318.18      0.25    673
2003       7    318.29      0.27    684
2003       8    318.34      0.31    675
2003       9    318.51      0.30    650
2003      10    318.60      0.31    676
2003      11    318.61      0.24    693
2003      12    318.64      0.24    716
2004       1    318.76      0.24    723
2004       2    318.69      0.28    643
2004       3    318.66      0.23    660
2004       4    318.75      0.24    706
2004       5    318.85      0.25    695
2004       6    318.91      0.24    676
2004       7    318.94      0.25    625
2004       8    319.03      0.34    575
2004       9    319.11      0.31    626
2004      10    319.20      0.26    689
2004      11    319.33      0.26    693
2004      12    319.34      0.26    668
2005       1    319.46      0.26    630
2005       2    319.53      0.21    629
2005       3    319.56      0.26    696
2005       4    319.56      0.24    679
2005       5    319.64      0.22    696
2005       6    319.66      0.23    644
2005       7    319.81      0.21    674
2005       8    319.96      0.31    686
2005       9    319.84      0.31    666
2005      10    319.91      0.45    718
2005      11    319.92      0.36    692
2005      12    320.16      0.30    564
2006       1    320.19      0.30    692
2006       2    320.16      0.29    591
2006       3    320.08      0.26    712
2006       4    320.29      0.28    690
2006       5    320.27      0.24    681
2006       6    320.41      0.26    649
2006       7    320.42      0.24    244
2006       8    320.46      0.37    124
2006       9    320.49      0.28    514
2006      10    320.71      0.31    607
2006      11    320.73      0.28    670
2006      12    320.95      0.36    670
2007       1    320.96      0.38    686
2007       2    321.07      0.31    641
2007       3    320.98      0.29    699
2007       4    321.24      0.37    667
2007       5    321.18      0.35    691
2007       6    321.28      0.30    679
2007       7    321.32      0.30    684
2007       8    321.33      0.41    581
2007       9    321.42      0.35    663
2007      10    321.56      0.30    671
2007      11    321.70      0.29    585
2007      12    321.76      0.39    643
2008       1    321.94      0.37    422
2008       2    321.89      0.32     71
2008       3    321.89      0.31    708
2008       4    322.05      0.22    698
2008       5    322.02      0.23    710
2008       6    322.10      0.21    674
2008       7    322.25      0.19    724
2008       8    322.29      0.21    724
2008       9    322.39      0.22    695
2008      10    322.63      0.23    708
2008      11    322.63      0.25    685
2008      12    322.66      0.23    697
2009       1    322.75      0.24    544
2009       2    322.68      0.19    667
2009       3    322.61      0.21    704
2009       4    322.75      0.20    711
2009       5    322.88      0.21    724
2009       6    322.90      0.21    699
2009       7    322.84      0.20    727
2009       8    322.95      0.17    739
2009       9    323.07      0.19    715
2009      10    323.12      0.19    738
2009      11    323.21      0.17    691
2009      12    323.36      0.18    734
2010       1    323.49      0.30    653
2010       2    323.35      0.50    308
2010       3     nan        nan       0
2010       4    323.58      0.20    680
2010       5    323.65      0.24    703
2010       6    323.71      0.26    682
2010       7    323.69      0.22    724
2010       8    323.79      0.21    611
2010       9    323.86      0.20    576
2010      10    324.15      0.22    738
2010      11    324.28      0.23    703
2010      12    324.43      0.23    676
2011       1    324.39      0.26    559
2011       2    324.48      0.25    641
2011       3    324.55      0.28    722
2011       4    324.57      0.32    610
2011       5    324.56      0.26    734
2011       6    324.59      0.26    647
2011       7    324.71      0.23    730
2011       8    324.85      0.19    724
2011       9    324.95      0.19    701
2011      10    325.09      0.20    729
2011      11    325.12      0.17    675
2011      12    325.21      0.19    713
2012       1    325.41      0.22    738
2012       2    325.51      0.28    674
2012       3    325.34      0.22    573
2012       4    325.48      0.23    699
2012       5    325.43      0.26    705
2012       6    325.39      0.21    683
2012       7    325.44      0.22    721
2012       8    325.55      0.24    718
2012       9    325.71      0.37    670
2012      10    325.95      0.44    702
2012      11    325.93      0.40    664
2012      12    326.04      0.19    723
2013       1    326.10      0.19    710
2013       2    326.13      0.21    623
2013       3    326.15      0.17    729
2013       4    326.32      0.17    705
2013       5    326.47      0.18    692
2013       6    326.37      0.24    701
2013       7    326.37      0.23    683
2013       8    326.56      0.24    430
2013       9    326.58      0.22    694
2013      10    326.62      0.21    728
2013      11    326.80      0.20    707
2013      12    326.90      0.21    726
2014       1    327.03      0.22    731
2014       2    327.19      0.20    665
2014       3    327.31      0.24    699
2014       4    327.37      0.24    699
2014       5    327.73      0.22    656
2014       6    327.83      0.22    694
2014       7    327.96      0.31    639
2014       8    327.60      0.33    578
2014       9    327.66      0.40    657
2014      10    327.85      0.32    599
2014      11    327.90      0.23    672
2014      12    327.97      0.21    668
2015       1    328.10      0.25    681
2015       2    328.13      0.25    661
2015       3    328.16      0.32    690
2015       4    328.28      0.21    656
2015       5    328.31      0.28    701
2015       6    328.24      0.25    635
2015       7    328.29      0.23    697
2015       8    328.38      0.34    629
2015       9    328.70      0.28    687
2015      10    328.85      0.28    715
2015      11    328.89      0.26    697
2015      12    328.92      0.24    655
2016       1    329.07      0.23    731
2016       2    329.04      0.25    671
2016       3    329.09      0.26    614
2016       4    329.20      0.30    678
2016       5    329.27      0.30    703
2016       6    329.29      0.37    680
2016       7    329.43      0.36    731
2016       8    329.63      0.35    696
2016       9    329.66      0.36    633
2016      10    329.89      0.52    644
2016      11    329.97      0.46    686
2016      12    329.94      0.45    661
2017       1    330.12      0.46    670
2017       2    330.11      0.49    654
2017       3    330.25      0.67    704
2017       4    330.15      0.84    669
2017       5    330.27      0.65    733
2017       6    330.29      0.95    697
2017       7    330.37      0.68    395
2017       8    330.68      0.70    725
2017       9    330.72      0.51    708
2017      10    330.87      0.54    717
2017      11    330.97      0.53    698
2017      12    331.15      0.60    696
2018       1    331.07      0.56    725
2018       2    331.14      0.76    657
2018       3    330.93      0.76    542
2018       4    331.05      0.65    689
2018       5    330.95      0.78    659
2018       6    331.02      0.94    473
2018       7    331.13      0.75    553
2018       8    331.54      0.68    687
2018       9    331.87      0.54    668
2018      10    332.22      0.60    646
2018      11    332.64      0.66    691
2018      12    332.80      0.76    742
2019       1    332.75      0.70    652")

n2o <- n2o[,1:3]

# Monthly Atmospheric Hydrochloroflurocarbon (HCFC) Concentration in ppt (1999-present)
hcfc <- read.table(header = TRUE, text = "
year month hcfc sd n
1999       1     10.84      0.50    637
1999       2     10.84      0.37     70
1999       3     11.15      0.47    516
1999       4     11.80      0.45    154
1999       5     11.68      0.37    590
1999       6     11.69      0.46    529
1999       7     10.90      0.56    621
1999       8     10.99      0.54    423
1999       9     11.45      0.39    306
1999      10     11.36      0.48    573
1999      11     11.60      0.49    572
1999      12     11.92      0.72    408
2000       1     11.86      0.83    591
2000       2     11.56      0.76    616
2000       3     11.74      0.82    741
2000       4     11.92      0.86    691
2000       5     11.77      0.82    668
2000       6     12.03      0.87    570
2000       7     12.05      0.82    590
2000       8     12.26      0.77    163
2000       9     12.30      0.83    319
2000      10     12.51      1.03    696
2000      11     12.57      1.14    345
2000      12     12.60      1.13    645
2001       1     12.85      0.99    453
2001       2     12.73      1.15    656
2001       3     12.75      1.18    736
2001       4     12.75      1.22    707
2001       5     12.70      1.13    737
2001       6     12.65      1.25    349
2001       7     13.01      1.24    114
2001       8     12.36      1.08    165
2001       9     13.21      0.98    321
2001      10     13.30      0.78    739
2001      11     13.36      0.77    416
2001      12     12.87      0.85    144
2002       1     12.95      0.92    115
2002       2     13.32      0.93    392
2002       3     13.37      0.77    732
2002       4     13.32      0.83    697
2002       5     13.44      0.83    703
2002       6     13.66      0.85    709
2002       7     13.37      0.89    683
2002       8     13.88      0.99    176
2002       9     nan        nan       0
2002      10     nan        nan       0
2002      11     nan        nan       0
2002      12     nan        nan       0
2003       1     nan        nan       0
2003       2     13.76      2.77     33
2003       3     13.19      2.16    551
2003       4     12.35      2.84     29
2003       5     nan        nan       0
2003       6     13.98      1.65    120
2003       7     14.54      1.81    248
2003       8     14.43      1.08    513
2003       9     14.58      0.78    636
2003      10     14.70      0.76    241
2003      11     14.90      0.75    523
2003      12     14.80      0.85    733
2004       1     14.28      0.76    732
2004       2     14.50      0.81    677
2004       3     14.56      0.82    675
2004       4     14.82      0.81    704
2004       5     14.69      0.81    689
2004       6     14.70      0.96    655
2004       7     14.78      0.86    651
2004       8     14.84      0.78    602
2004       9     15.13      0.77    623
2004      10     15.23      0.80    713
2004      11     15.16      0.88    715
2004      12     15.09      0.82    685
2005       1     15.16      0.84    663
2005       2     15.12      0.85    634
2005       3     15.30      0.81    708
2005       4     15.07      0.85    551
2005       5     15.19      0.93    489
2005       6     15.36      0.81    185
2005       7     15.34      0.96    450
2005       8     15.67      1.04    391
2005       9     15.85      0.76    442
2005      10     16.04      0.76    393
2005      11     nan        nan       0
2005      12     nan        nan       0
2006       1     nan        nan       0
2006       2     nan        nan       0
2006       3     nan        nan       0
2006       4     16.50      0.82    142
2006       5     16.66      0.86    699
2006       6     16.51      1.00    674
2006       7     16.54      1.00    673
2006       8     16.48      0.95    709
2006       9     16.79      0.89    532
2006      10     17.00      0.88    616
2006      11     17.21      1.05    686
2006      12     17.26      1.16    708
2007       1     17.43      1.86    678
2007       2     16.66      2.66    541
2007       3     17.35      2.51    672
2007       4     17.50      2.18    647
2007       5     16.81      3.22    342
2007       6     17.42      1.88    168
2007       7     17.58      1.79    215
2007       8     17.87      1.94    585
2007       9     18.27      2.20    591
2007      10     18.19      2.66    576
2007      11     17.93      1.25    351
2007      12     18.17      0.52    700
2008       1     19.14      0.63    417
2008       2     nan        nan       0
2008       3     nan        nan       0
2008       4     nan        nan       0
2008       5     nan        nan       0
2008       6     18.28      1.78    639
2008       7     19.43      2.01    672
2008       8     19.40      1.51    689
2008       9     19.17      1.83    660
2008      10     19.57      1.26    417
2008      11     19.85      0.94    461
2008      12     19.71      1.00    655
2009       1     20.34      1.00    706
2009       2     20.95      0.92    668
2009       3     20.96      0.99    663
2009       4     21.01      1.02    710
2009       5     21.14      0.97    717
2009       6     20.65      0.96    702
2009       7     20.00      1.10    725
2009       8     20.26      1.00    663
2009       9     20.22      1.24    719
2009      10     20.84      1.27    731
2009      11     20.30      1.23    705
2009      12     20.26      1.62    713
2010       1     19.77      1.65    715
2010       2     20.23      1.78    659
2010       3     19.84      2.16    686
2010       4     19.91      2.45    558
2010       5     20.52      2.83    358
2010       6     20.23      1.22    672
2010       7     20.98      1.13    723
2010       8     20.87      1.05    635
2010       9     21.18      1.02    561
2010      10     21.36      1.08    722
2010      11     21.27      0.91    702
2010      12     21.04      0.81    685
2011       1     20.99      0.86    583
2011       2     20.82      0.94    663
2011       3     20.99      1.03    717
2011       4     20.80      1.10    704
2011       5     21.04      1.02    657
2011       6     20.99      1.16    595
2011       7     20.92      1.35    730
2011       8     20.93      1.56    740
2011       9     21.08      1.57    623
2011      10     21.52      1.45    733
2011      11     21.36      1.53    706
2011      12     21.14      1.62    729
2012       1     21.81      1.73    727
2012       2     21.20      1.49    622
2012       3     21.33      1.23    549
2012       4     21.23      1.42    705
2012       5     21.69      1.33    715
2012       6     21.54      1.46    669
2012       7     21.45      1.67    684
2012       8     21.72      1.70    685
2012       9     22.03      1.64    649
2012      10     21.95      1.61    578
2012      11     22.20      1.25    713
2012      12     21.75      1.29    728
2013       1     21.83      1.07    654
2013       2     21.51      1.04    651
2013       3     21.78      1.01    706
2013       4     21.91      1.24    707
2013       5     22.31      1.65    713
2013       6     22.04      1.49    697
2013       7     22.12      1.32    679
2013       8     22.15      1.70    518
2013       9     22.29      2.02    644
2013      10     22.44      1.47    519
2013      11     22.01      1.33    663
2013      12     22.35      1.34    712
2014       1     22.03      1.09    730
2014       2     21.69      1.12    603
2014       3     22.19      1.16    698
2014       4     22.76      1.16    705
2014       5     22.35      1.19    657
2014       6     23.34      1.19    676
2014       7     23.08      0.92    712
2014       8     23.24      0.71    612
2014       9     23.39      0.74    709
2014      10     23.12      0.66    629
2014      11     23.51      0.71    696
2014      12     23.57      0.59    669
2015       1     23.21      0.66    720
2015       2     23.08      0.68    666
2015       3     23.30      0.59    726
2015       4     23.50      0.67    703
2015       5     23.17      0.71    709
2015       6     22.84      0.76    660
2015       7     22.43      0.70    729
2015       8     22.16      0.72    678
2015       9     22.41      0.89    695
2015      10     22.79      1.02    731
2015      11     22.67      1.09    719
2015      12     21.97      0.86    609
2016       1     22.10      0.97    717
2016       2     22.15      0.92    677
2016       3     21.10      0.86    585
2016       4     21.81      1.12    680
2016       5     22.05      0.87    721
2016       6     22.64      0.65    711
2016       7     22.44      0.68    731
2016       8     22.63      0.56    694
2016       9     23.03      0.54    679
2016      10     23.20      0.66    731
2016      11     23.25      0.66    715
2016      12     23.18      0.71    142
2017       1     nan        nan       0
2017       2     22.75      0.54    666
2017       3     22.47      0.54    645
2017       4     22.63      0.58    708
2017       5     22.74      0.40    713
2017       6     22.58      0.42    684
2017       7     22.53      0.48    433")

hcfc <- hcfc[,1:3]

# Monthly Atmospheric Sulfur Hexaflouride (SF6) Concentration in ppt (1999-present)
sf6 <- read.table(header = TRUE, text = "
year month sf6 sd n
1999       7     4.430     0.048    556
1999       8     4.438     0.043    586
1999       9     4.506     0.025    481
1999      10     4.506     0.024    629
1999      11     4.537     0.030    324
1999      12     4.571     0.038    311
2000       1     nan        nan       0
2000       2     4.571     0.059    432
2000       3     4.585     0.074    547
2000       4     4.625     0.038    546
2000       5     4.606     0.054    655
2000       6     4.658     0.046    546
2000       7     4.665     0.037    577
2000       8     4.678     0.050    157
2000       9     4.728     0.039    204
2000      10     4.736     0.047    681
2000      11     4.663     0.116     75
2000      12     4.738     0.111    519
2001       1     4.782     0.076    424
2001       2     4.808     0.063    620
2001       3     4.820     0.074    692
2001       4     4.853     0.043    691
2001       5     4.856     0.031    728
2001       6     4.843     0.047    345
2001       7     4.881     0.074    640
2001       8     4.857     0.094    725
2001       9     4.908     0.108    705
2001      10     4.934     0.090    622
2001      11     4.959     0.103    644
2001      12     4.936     0.141    618
2002       1     4.967     0.152    656
2002       2     4.952     0.084    655
2002       3     5.041     0.172    574
2002       4     5.080     0.151    682
2002       5     4.974     0.122    272
2002       6     nan        nan       0
2002       7     nan        nan       0
2002       8     nan        nan       0
2002       9     5.125     0.052    132
2002      10     5.140     0.024    718
2002      11     5.156     0.030    695
2002      12     5.169     0.022    708
2003       1     5.185     0.032    578
2003       2     5.174     0.030     24
2003       3     5.204     0.037    715
2003       4     5.246     0.071    697
2003       5     5.240     0.037    735
2003       6     5.272     0.040    693
2003       7     5.272     0.039    682
2003       8     5.283     0.043    701
2003       9     5.336     0.041    662
2003      10     5.339     0.042    699
2003      11     5.365     0.041    695
2003      12     5.378     0.040    732
2004       1     5.352     0.041    728
2004       2     5.374     0.038    664
2004       3     5.391     0.038    677
2004       4     5.438     0.045    712
2004       5     5.471     0.047    679
2004       6     5.493     0.042    684
2004       7     5.530     0.047    647
2004       8     5.503     0.046    601
2004       9     5.561     0.046    661
2004      10     5.563     0.046    700
2004      11     5.596     0.044    711
2004      12     5.597     0.044    684
2005       1     5.601     0.041    660
2005       2     5.632     0.046    641
2005       3     5.683     0.046    711
2005       4     5.679     0.046    687
2005       5     5.694     0.057    700
2005       6     5.726     0.051    681
2005       7     5.714     0.057    708
2005       8     5.734     0.051    717
2005       9     5.751     0.033    713
2005      10     5.779     0.028    718
2005      11     5.784     0.028    715
2005      12     5.829     0.036    602
2006       1     5.858     0.043    708
2006       2     5.879     0.050    608
2006       3     5.883     0.045    716
2006       4     5.956     0.046    700
2006       5     5.959     0.051    696
2006       6     5.964     0.047    651
2006       7     5.970     0.049    661
2006       8     5.976     0.057    659
2006       9     6.024     0.043    534
2006      10     6.040     0.044    621
2006      11     6.051     0.050    653
2006      12     6.116     0.054    687
2007       1     6.127     0.048    680
2007       2     6.144     0.043    646
2007       3     6.101     0.035    417
2007       4     nan        nan       0
2007       5     6.179     0.038    612
2007       6     6.209     0.037    684
2007       7     6.218     0.041    691
2007       8     6.274     0.045    607
2007       9     6.277     0.041    686
2007      10     6.333     0.039    688
2007      11     6.344     0.038    621
2007      12     6.353     0.043    698
2008       1     6.401     0.053    490
2008       2     6.347     0.024     71
2008       3     6.377     0.025    736
2008       4     6.431     0.028    718
2008       5     6.479     0.026    728
2008       6     6.496     0.028    709
2008       7     6.500     0.027    739
2008       8     6.528     0.029    732
2008       9     6.526     0.023    689
2008      10     6.606     0.028    720
2008      11     6.617     0.029    711
2008      12     6.624     0.028    741
2009       1     6.651     0.029    730
2009       2     6.670     0.024    667
2009       3     6.721     0.034    731
2009       4     6.730     0.040    715
2009       5     6.742     0.043    739
2009       6     6.774     0.046    709
2009       7     6.751     0.042    743
2009       8     6.757     0.045    743
2009       9     6.816     0.042    719
2009      10     6.854     0.043    742
2009      11     6.892     0.042    719
2009      12     6.847     0.040    414
2010       1     6.992     0.073    307
2010       2     6.986     0.055    672
2010       3     7.016     0.058    738
2010       4     7.012     0.050    707
2010       5     7.063     0.053    735
2010       6     7.125     0.045    701
2010       7     7.155     0.044    715
2010       8     7.155     0.044    634
2010       9     7.218     0.047    592
2010      10     7.253     0.046    742
2010      11     7.277     0.048    715
2010      12     7.235     0.037    680
2011       1     7.284     0.031    579
2011       2     7.299     0.029    671
2011       3     7.295     0.054    687
2011       4     7.319     0.065    577
2011       5     7.380     0.028    743
2011       6     7.402     0.031    668
2011       7     7.426     0.034    742
2011       8     7.426     0.034    738
2011       9     7.481     0.033    705
2011      10     7.540     0.032    735
2011      11     7.521     0.034    683
2011      12     7.543     0.026    735
2012       1     7.572     0.028    664
2012       2     7.583     0.058    687
2012       3     7.606     0.033    602
2012       4     7.647     0.026    719
2012       5     7.663     0.023    721
2012       6     7.661     0.020    689
2012       7     7.646     0.022    733
2012       8     7.671     0.022    737
2012       9     7.727     0.020    696
2012      10     7.738     0.020    712
2012      11     7.819     0.023    707
2012      12     7.805     0.021    737
2013       1     7.816     0.021    728
2013       2     7.882     0.025    320
2013       3     7.885     0.024    737
2013       4     7.934     0.025    706
2013       5     8.039     0.025    725
2013       6     8.013     0.028    711
2013       7     8.052     0.030    685
2013       8     8.110     0.026    430
2013       9     8.155     0.023    700
2013      10     8.146     0.020    725
2013      11     8.155     0.023    719
2013      12     8.208     0.022    738
2014       1     8.202     0.022    731
2014       2     8.198     0.021    667
2014       3     8.284     0.020    702
2014       4     8.336     0.021    715
2014       5     8.338     0.021    658
2014       6     8.382     0.023    718
2014       7     8.367     0.025    675
2014       8     8.405     0.022    587
2014       9     8.482     0.022    674
2014      10     8.488     0.020    604
2014      11     8.507     0.016    702
2014      12     8.520     0.017    706
2015       1     8.521     0.018    726
2015       2     8.513     0.018    654
2015       3     8.553     0.021    718
2015       4     8.635     0.016    693
2015       5     8.680     0.022    728
2015       6     8.658     0.021    651
2015       7     8.661     0.019    730
2015       8     8.641     0.022    664
2015       9     8.778     0.022    696
2015      10     8.799     0.020    726
2015      11     8.846     0.021    703
2015      12     8.873     0.025    700
2016       1     8.845     0.025    731
2016       2     8.891     0.028    690
2016       3     8.898     0.030    619
2016       4     8.995     0.027    706
2016       5     9.006     0.029    739
2016       6     9.029     0.032    707
2016       7     9.000     0.035    743
2016       8     9.008     0.033    713
2016       9     9.065     0.054    673
2016      10     9.132     0.068    686
2016      11     9.192     0.048    711
2016      12     9.135     0.045    681
2017       1     9.193     0.052    680
2017       2     9.183     0.048    644
2017       3     9.188     0.049    713
2017       4     9.271     0.052    711
2017       5     9.313     0.048    743
2017       6     9.333     0.050    711
2017       7     9.356     0.048    574
2017       8     9.418     0.041    743
2017       9     9.510     0.039    712
2017      10     9.540     0.045    726
2017      11     9.558     0.044    714
2017      12     9.572     0.038    718
2018       1     9.590     0.043    734
2018       2     9.585     0.043    656
2018       3     9.635     0.047    720
2018       4     9.652     0.061    707
2018       5     9.548     0.217     92
2018       6     9.777     0.189    201
2018       7     9.738     0.082    599
2018       8     9.681     0.067    700
2018       9     9.814     0.091    664
2018      10     9.915     0.095    655
2018      11     9.938     0.081    698
2018      12     9.960     0.080    718
2019       1     9.992     0.086    662")

sf6 <- sf6[,1:3]

# merge additional datasets and clean up
climate <- merge(climate, n2o, by=c("year", "month"), all.x = TRUE)
climate <- subset(climate, !is.na(n2o))
climate <- merge(climate, hcfc, by=c("year", "month"), all.x=TRUE)
climate <- subset(climate, !is.na(hcfc))
climate <- merge(climate, sf6, by = c("year", "month"), all.x = TRUE)
climate <- subset(climate, !is.na(sf6))

# with so many observations removed for missing data, renumber the rows
rownames(climate) <- 1:dim(climate)[1]

str(climate)

# EDA
# Compute the correlation coefficient for 'temp' and each explanatory variable
cor(climate$temp, climate[, 4:8])

# Analysis

# Model: Temp = beta0 + beta1 co2 + beta2 methane + beta3 n2o + beta4 hcfc + beta5 sf6 + epsilon, epsilon~N(0 sigma2)
out_climate <- lm(temp ~ co2 + methane + n2o + hcfc + sf6, data = climate)
summary(out_climate)

# Collinearity - redundancy (high correlation) between explanatory variables (or Multicollinearity)
# To see the collinearity, plot explanatory variables
plot(~ co2 + methane + n2o + hcfc + sf6, data = climate)

# Estimates have the wrong sign (negative or positive) compared to the correlation coefficient sign
# Predictions are okay
# Model is significant, but important variables are not significant.

# What to do when you see the collinearity problem?
# 1a. Designed experiment (STAT 230).
# 1b. Go back to simple model without the new chemical additions because they just complicated the model.
# 2. Fit a subset regression model:
  # Get the right signs (matching estimates with correlation coefficients)
  # Inference - find statistical significance
  # To find the right model, find the chemicals that correlate the least with co2 and methane (look at plots)-- sf6

out_climate1 <- lm(temp ~ co2 + methane + sf6, data = climate)
coef(out_climate1)
# If goal is prediction this model makes sense because all signs make sense.
# For inference, only co2 and sf6 are not significant, so more data is needed
# Instead uses this model:
out_climate2 <- lm(temp ~ co2 + methane, data = climate)
summary(out_climate2)
# Signs all match and both explanatory variables are significant.

